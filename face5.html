<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Wazi Hub — See More. Know More. Do More.</title>
<meta name="description" content="Wazi Hub: Kenya Public Finance & Projects Dashboard — budget transparency, contracting openness, project tracking, and citizen feedback." />
<meta name="author" content="Wazi Hub" />
<link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Crect width='48' height='16' y='0' fill='%23000000'/%3E%3Crect width='48' height='16' y='16' fill='%23BB1919'/%3E%3Crect width='48' height='16' y='32' fill='%2300853F'/%3E%3C/svg%3E" />

<!-- Chart.js (for interactive charts) -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>

<!-- Leaflet (interactive map) -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<style>
  /* ===== CSS RESET + BASE ===== */
  *, *::before, *::after { box-sizing: border-box; }
  html:focus-within { scroll-behavior: smooth; }
  body { 
    margin:0; 
    font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, "Helvetica Neue", Arial, "Noto Sans"; 
    line-height:1.6; 
    color:#1a1a1a; 
    background:#fafafa; 
    font-size: 16px;
  }
  img, svg, video, canvas { max-width:100%; height:auto; }
  :root{
    --kenya-black:#000000; --kenya-red:#BB1919; --kenya-green:#00853F; --kenya-white:#FFFFFF;
    --ink:#1a1a1a; --muted:#6b7280; --card:#ffffff; --border:#e5e7eb; --focus:#3b82f6; --radius:12px;
    --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
    --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
    --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
    --gradient-primary: linear-gradient(135deg, var(--kenya-green) 0%, #00a854 100%);
    --gradient-secondary: linear-gradient(135deg, var(--kenya-red) 0%, #d32f2f 100%);
  }
  .container{ 
    max-width:1200px; 
    margin-inline:auto; 
    padding: clamp(16px, 3vw, 24px); 
  }
  .skip{ position: absolute; left:-9999px; top:auto; width:1px; height:1px; overflow:hidden;}
  .skip:focus{ position: static; width:auto; height:auto; background:#fff; padding:.75rem 1rem; border:2px solid var(--focus); border-radius:var(--radius); z-index:9999; box-shadow: var(--shadow-md);}
  .muted{ color:var(--muted); }

  /* ===== HEADER ===== */
  .site-header{ 
    position:sticky; 
    top:0; 
    z-index:50; 
    background:linear-gradient(90deg,var(--kenya-black) 0 30%, var(--kenya-red) 30% 65%, var(--kenya-green) 65% 100%);
    box-shadow: var(--shadow-lg);
    backdrop-filter: blur(10px);
  }
  .brand{ 
    display:flex; 
    align-items:center; 
    gap:1rem; 
    padding:.5rem 0; 
  }
  .brand .logo{ 
    width:48px; 
    height:32px; 
    border:2px solid #fff; 
    border-radius:6px; 
    display:grid; 
    grid-template-rows:1fr 1fr 1fr; 
    overflow:hidden;
    box-shadow: var(--shadow-sm);
  }
  .brand .logo span:nth-child(1){ background:var(--kenya-black); }
  .brand .logo span:nth-child(2){ background:var(--kenya-red); }
  .brand .logo span:nth-child(3){ background:var(--kenya-green); }
  .brand h1{ 
    margin:0; 
    font-size: clamp(1.5rem, 4vw, 2rem); 
    color:#fff; 
    letter-spacing:-0.025em; 
    font-weight: 800;
  }
  .brand small{ 
    color:#fff; 
    opacity:.9; 
    font-weight:500; 
    font-size:.875rem; 
    letter-spacing: 0.025em;
  }

  nav ul{ 
    list-style:none; 
    margin:0; 
    padding:0; 
    display:flex; 
    flex-wrap:wrap; 
    gap:.5rem; 
  }
  nav a{ 
    display:inline-block; 
    padding:.625rem 1rem; 
    font-weight:600; 
    text-decoration:none; 
    background:rgba(255,255,255,.1); 
    color:#fff; 
    border:1px solid rgba(255,255,255,.2); 
    border-radius:999px; 
    transition: all 0.2s ease;
    font-size: 0.875rem;
  }
  nav a:hover, nav a:focus{ 
    background:#fff; 
    color:var(--kenya-black); 
    outline: none; 
    transform: translateY(-1px);
    box-shadow: var(--shadow-md);
  }

  /* ===== HERO ===== */
  #home{ 
    background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
    border-bottom:1px solid var(--border);
    padding: 3rem 0;
  }
  #home h2{ 
    font-size: clamp(2rem, 5vw, 3rem); 
    margin: 0 0 1rem; 
    font-weight: 900;
    line-height: 1.1;
    letter-spacing: -0.025em;
    color: var(--ink);
  }
  .cta-row{ 
    display:flex; 
    flex-wrap:wrap; 
    gap:1rem; 
    margin-top:1.5rem; 
  }

  /* ===== UTILS ===== */
  .flex{ display:flex; gap:1rem; align-items:center;}
  .grid{ display:grid; gap:1.5rem; }
  .grid-2{ grid-template-columns: repeat(2, minmax(0,1fr)); }
  .grid-3{ grid-template-columns: repeat(3, minmax(0,1fr)); }
  @media (max-width: 768px){ 
    .grid-3{ grid-template-columns:1fr; } 
    .grid-2{ grid-template-columns:1fr; } 
    nav ul{ justify-content: center; } 
    .cta-row { justify-content: center; }
  }
  .btn{ 
    --bg:var(--kenya-green); 
    --fg:#fff;
    background: var(--bg); 
    color:var(--fg); 
    border:0; 
    border-radius:999px; 
    padding:1rem 1.5rem; 
    font-weight:700; 
    text-decoration:none; 
    display:inline-flex; 
    gap:.5rem; 
    align-items:center; 
    justify-content:center; 
    cursor:pointer; 
    box-shadow: var(--shadow-md);
    transform: translateY(0); 
    transition: all 0.2s ease;
    font-size: 0.875rem;
    min-height: 48px;
  }
  .btn:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-lg);
  }
  .btn:active{ 
    transform: translateY(0); 
  }
  .btn.secondary{ 
    --bg:#fff; 
    --fg:var(--kenya-black); 
    border:2px solid var(--kenya-black);
  }
  .badge{ 
    display:inline-block; 
    padding:.375rem .75rem; 
    border-radius:999px; 
    font-weight:600; 
    font-size:.75rem; 
    background:#f3f4f6; 
    color: #374151;
  }
  .badge[data-status="ongoing"]{ background:#dcfce7; color:#166534; }
  .badge[data-status="awarded"]{ background:#fef2f2; color:#991b1b; }

  /* ===== CARDS / PANELS ===== */
  .card{ 
    background:var(--card); 
    border:1px solid var(--border); 
    border-radius:var(--radius); 
    padding:1.5rem; 
    box-shadow: var(--shadow-sm);
    transition: all 0.2s ease;
  }
  .card:hover {
    box-shadow: var(--shadow-md);
    transform: translateY(-1px);
  }
  .panel-title{ 
    font-size:1.25rem; 
    font-weight:800; 
    margin: 0 0 1rem; 
    color: var(--ink);
    letter-spacing: -0.025em;
  }

  /* ===== CHART AREAS ===== */
  .chart-wrap{ 
    background: #ffffff; 
    border:1px solid var(--border); 
    border-radius: var(--radius); 
    padding: 1.5rem; 
    box-shadow: var(--shadow-sm);
  }
  .chart-box{ 
    position:relative; 
    height: 300px; 
  }
  @media (min-width: 1200px){ 
    .chart-box{ height: 320px; } 
  }
  .legend{ 
    display:grid; 
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap:.75rem; 
    margin-top:1rem; 
    font-size:.875rem; 
  }

  /* ===== TABLE ===== */
  table{ 
    width:100%; 
    border-collapse: collapse; 
    background:#fff; 
    border:1px solid var(--border); 
    border-radius:var(--radius); 
    overflow:hidden; 
    box-shadow: var(--shadow-sm);
  }
  th, td{ 
    padding:1rem; 
    border-bottom:1px solid var(--border); 
    text-align:left; 
    font-size:0.875rem; 
  }
  thead th{ 
    background:#f9fafb; 
    font-size:0.875rem; 
    font-weight: 600;
    color: var(--ink);
  }
  tbody tr:hover {
    background: #f9fafb;
  }
  caption{ padding:.75rem; }

  /* ===== FORM ===== */
  label{ 
    display:flex; 
    flex-direction:column; 
    gap:.5rem; 
    font-weight:600; 
    color: var(--ink);
  }
  input, select, textarea{ 
    padding:.875rem 1rem; 
    border:1px solid #d1d5db; 
    border-radius:var(--radius); 
    font-size:0.875rem; 
    background:#fff; 
    transition: all 0.2s ease;
  }
  input:focus, select:focus, textarea:focus, .btn:focus{ 
    outline:2px solid var(--focus); 
    outline-offset:2px; 
    border-color: var(--focus);
  }
  progress{ 
    width:100%; 
    height:8px; 
    accent-color: var(--kenya-green); 
    border-radius: 4px;
  }

  /* ===== USSD/WHATSAPP ===== */
  .channels{ 
    display:grid; 
    grid-template-columns: repeat(2, minmax(0,1fr)); 
    gap:1.5rem; 
  }
  @media (max-width: 768px){ 
    .channels{ grid-template-columns: 1fr; } 
  }
  .channel{ 
    display:flex; 
    gap:1.5rem; 
    align-items:center; 
    padding:1.5rem; 
    background:#ffffff; 
    border:1px solid var(--border); 
    border-radius:var(--radius); 
    box-shadow: var(--shadow-sm);
    transition: all 0.2s ease;
  }
  .channel:hover {
    box-shadow: var(--shadow-md);
    transform: translateY(-2px);
  }
  .channel svg{ 
    width:48px; 
    height:48px; 
    flex-shrink: 0;
  }
  .channel .big{ 
    font-weight:800; 
    font-size: clamp(1.125rem, 3vw, 1.375rem); 
    margin-bottom: 0.5rem;
  }
  .ussd{ 
    background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%); 
    border-color:#bbf7d0; 
  }
  .whatsapp{ 
    background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%); 
    border-color:#bbf7d0; 
  }

  /* ===== MAP ===== */
  #map{ 
    height:320px; 
    border:1px solid var(--border); 
    border-radius:var(--radius); 
    box-shadow: var(--shadow-sm);
  }

  /* ===== FOOTER ===== */
  footer{ 
    background:#111827; 
    color:#f9fafb; 
    margin-top: 3rem; 
    padding: 2rem 0;
  }
  footer a{ 
    color:#60a5fa; 
    text-decoration: none;
    transition: color 0.2s ease;
  }
  footer a:hover {
    color: #93c5fd;
  }

  /* ===== RESPONSIVE IMPROVEMENTS ===== */
  @media (max-width: 640px) {
    .container {
      padding: 1rem;
    }
    .brand {
      flex-direction: column;
      text-align: center;
      gap: 0.5rem;
    }
    nav ul {
      gap: 0.25rem;
    }
    nav a {
      padding: 0.5rem 0.75rem;
      font-size: 0.75rem;
    }
    .chart-wrap {
      padding: 1rem;
    }
    .chart-box {
      height: 250px;
    }
    .card {
      padding: 1rem;
    }
    .channel {
      flex-direction: column;
      text-align: center;
      gap: 1rem;
    }
  }

  /* ===== ANIMATIONS ===== */
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .fade-in-up {
    animation: fadeInUp 0.6s ease-out;
  }

  /* ===== LOADING STATES ===== */
  .loading {
    opacity: 0.6;
    pointer-events: none;
  }

  .loading::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 20px;
    height: 20px;
    margin: -10px 0 0 -10px;
    border: 2px solid #f3f3f3;
    border-top: 2px solid var(--kenya-green);
    border-radius: 50%;
    animation: spin 1s linear infinite;
  }

  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
</style>
</head>
<body>
<a href="#main" class="skip">Skip to content</a>

<!-- ===== HEADER ===== -->
<header class="site-header" role="banner">
  <div class="container" style="display:flex; justify-content:space-between; align-items:center; gap:.75rem; flex-wrap:wrap;">
    <div class="brand" aria-label="Wazi Hub home">
      <div class="logo" aria-hidden="true"><span></span><span></span><span></span></div>
      <div>
        <h1 data-i18n="brand.name">WaziHub</h1>
        <small data-i18n="brand.tag">See More • Know More • Do More</small>
      </div>
    </div>
    <nav aria-label="Primary">
      <ul>
        <li><a href="#home" data-i18n="nav.home">Home</a></li>
        <li><a href="#budget-tracker" data-i18n="nav.budgets">Budgets</a></li>
        <li><a href="#open-contracting" data-i18n="nav.contracts">Contracts</a></li>
        <li><a href="#projects" data-i18n="nav.projects">Projects</a></li>
        <li><a href="#channels" data-i18n="nav.channels">USSD & WhatsApp</a></li>
        <li><a href="#report" data-i18n="nav.report">Report</a></li>
        <li><a href="#about" data-i18n="nav.about">About</a></li>
      </ul>
    </nav>
  </div>
</header>

<main id="main" tabindex="-1">
  <!-- ===== HERO ===== -->
  <section id="home">
    <div class="container">
      <h2 aria-live="polite" data-i18n="hero.title">See More. Know More. Do More.</h2>
      <p class="muted" style="font-size:1.1rem; max-width:65ch;" data-i18n="hero.text">
        Track budgets, monitor projects, follow contracts, and hold leaders accountable — all in one easy dashboard built for everyone in Kenya.
      </p>
      <div class="cta-row">
        <a class="btn" href="#budget-tracker" style="--bg:var(--primary-green)" data-i18n="cta.budgets">Explore Budgets</a>
        <a class="btn secondary" href="#open-contracting" data-i18n="cta.contracts">Open Contracting</a>
        <a class="btn" href="#report" style="--bg:var(--error-red)" data-i18n="cta.report">Report an Issue</a>
      </div>
    </div>
  </section>

  <!-- ===== HIGHLIGHTS ===== -->
  <section id="highlights" class="container" aria-labelledby="highlights-title" style="margin-top:1rem;">
    <h3 id="highlights-title" class="panel-title" data-i18n="hl.title">Highlights</h3>
    <div class="grid grid-3">
      <article class="card">
        <h4 class="panel-title" style="color:var(--kenya-red)" data-i18n="hl.a.title">Where is your county's money going?</h4>
        <p class="muted" data-i18n="hl.a.text">Quick view of allocations by sector for your county.</p>
      </article>
      <article class="card">
        <h4 class="panel-title" style="color:var(--kenya-red)" data-i18n="hl.b.title">Who won the latest tenders?</h4>
        <p class="muted" data-i18n="hl.b.text">Search contractors, awards, and red flags.</p>
      </article>
      <article class="card">
        <h4 class="panel-title" style="color:var(--kenya-red)" data-i18n="hl.c.title">Is that road really 80% complete?</h4>
        <p class="muted" data-i18n="hl.c.text">Project statuses, photos, and community updates.</p>
      </article>
    </div>
  </section>

  <!-- ===== LANGUAGE SELECTOR (ABOVE BUDGET TRACKER) ===== -->
  <section id="language-bar" aria-label="Language switcher">
    <div class="container card" style="display:flex; justify-content:space-between; align-items:center; gap:1rem; flex-wrap:wrap;">
      <div class="flex" style="gap:.5rem;">
        <strong data-i18n="lang.label">Language / Lugha:</strong>
        <span class="muted" data-i18n="lang.beta">Translation (Beta)</span>
      </div>
      <div class="flex" style="gap:.5rem;">
        <select id="language-select" aria-label="Choose language">
          <option value="en">English</option>
          <option value="sw">Kiswahili</option>
          <option value="ki">Gikuyu</option>
          <option value="luo">Dholuo</option>
          <option value="kamba">Kikamba</option>
          <option value="luy">Luhya</option>
          <option value="kal">Kalenjin</option>
          <option value="som">Somali</option>
          <option value="tuk">Turkana</option>
          <option value="meru">Kĩmerũ</option>
        </select>
        <button class="btn" id="apply-lang" type="button" style="--bg:var(--primary-green)" data-i18n="lang.apply">Apply</button>
      </div>
    </div>
  </section>

  <!-- ===== BUDGET TRACKER ===== -->
  <section id="budget-tracker" aria-labelledby="budget-title" style="margin-top:.5rem;">
    <div class="container">
      <h3 id="budget-title" class="panel-title" style="font-size:1.6rem;" data-i18n="budget.title">Open Budget Tracker</h3>

      <!-- Filters -->
      <form id="filters" class="grid" style="grid-template-columns: repeat(4, minmax(0, 1fr)); gap:.8rem; align-items:end;">
        <label><span data-i18n="filters.year">Year</span>
          <select id="year">
            <option>2025/26</option><option>2024/25</option><option>2023/24</option><option>2022/23</option>
            <option>2021/22</option><option>2020/21</option><option>2019/20</option><option>2018/19</option>
          </select>
        </label>
        <label><span data-i18n="filters.sector">Sector</span>
          <select id="sector">
            <option data-i18n="filters.allSectors">All sectors</option>
            <option>Health</option><option>Education</option><option>Infrastructure</option><option>Agriculture</option>
            <option>Water & Sanitation</option><option>Transport</option><option>Energy</option>
            <option>Security</option><option>Governance</option><option>Environment</option>
            <option>Trade & Industry</option><option>Tourism</option><option>Youth Affairs</option><option>Gender & Social Services</option>
          </select>
        </label>
        <label><span data-i18n="filters.county">County</span>
          <select id="county">
            <option data-i18n="filters.allCounties">All counties</option>
            <option value="baringo">Baringo</option>
            <option value="bomet">Bomet</option>
            <option value="bungoma">Bungoma</option>
            <option value="busia">Busia</option>
            <option value="elgeyo-marakwet">Elgeyo-Marakwet</option>
            <option value="embu">Embu</option>
            <option value="garissa">Garissa</option>
            <option value="homa-bay">Homa Bay</option>
            <option value="isiolo">Isiolo</option>
            <option value="kajiado">Kajiado</option>
            <option value="kakamega">Kakamega</option>
            <option value="kericho">Kericho</option>
            <option value="kiambu">Kiambu</option>
            <option value="kilifi">Kilifi</option>
            <option value="kirinyaga">Kirinyaga</option>
            <option value="kisii">Kisii</option>
            <option value="kisumu">Kisumu</option>
            <option value="kitui">Kitui</option>
            <option value="kwale">Kwale</option>
            <option value="laikipia">Laikipia</option>
            <option value="lamu">Lamu</option>
            <option value="machakos">Machakos</option>
            <option value="makueni">Makueni</option>
            <option value="mandera">Mandera</option>
            <option value="marsabit">Marsabit</option>
            <option value="meru">Meru</option>
            <option value="migori">Migori</option>
            <option value="mombasa">Mombasa</option>
            <option value="muranga">Murang'a</option>
            <option value="nairobi">Nairobi</option>
            <option value="nakuru">Nakuru</option>
            <option value="nandi">Nandi</option>
            <option value="narok">Narok</option>
            <option value="nyamira">Nyamira</option>
            <option value="nyandarua">Nyandarua</option>
            <option value="nyeri">Nyeri</option>
            <option value="samburu">Samburu</option>
            <option value="siaya">Siaya</option>
            <option value="taita-taveta">Taita-Taveta</option>
            <option value="tana-river">Tana River</option>
            <option value="tharaka-nithi">Tharaka-Nithi</option>
            <option value="trans-nzoia">Trans Nzoia</option>
            <option value="turkana">Turkana</option>
            <option value="uasin-gishu">Uasin Gishu</option>
            <option value="vihiga">Vihiga</option>
            <option value="wajir">Wajir</option>
            <option value="west-pokot">West Pokot</option>
          </select>
        </label>
        <button type="button" id="update" class="btn" data-i18n="filters.update">Update Data</button>
      </form>

      <!-- Charts -->
      <div class="grid grid-2" style="margin-top:1rem;">
        <div class="chart-wrap">
          <div class="panel-title" data-i18n="chart.pieTitle">Budget Allocation by Sector</div>
          <div class="chart-box"><canvas id="pie"></canvas></div>
          <div id="pie-legend" class="legend" aria-live="polite"></div>
        </div>
        <div class="chart-wrap">
          <div class="panel-title" data-i18n="chart.barTitle">Planned vs Actual — Quarterly</div>
          <div class="chart-box"><canvas id="bars"></canvas></div>
          <p class="muted" style="margin:.3rem 0 0;" data-i18n="chart.tip">Tip: Tap a legend item to hide/show a series.</p>
        </div>
      </div>

      <!-- Summary Cards -->
      <div class="grid grid-3" style="margin-top:1rem;">
        <div class="card summary-card total-budget">
          <div id="total-budget" class="amount">KSh 3.32T</div>
          <div class="muted" data-i18n="sum.totalBudget">Total Budget (selected)</div>
        </div>
        <div class="card summary-card total-spent">
          <div id="total-spent" class="amount">KSh 2.10T</div>
          <div class="muted" data-i18n="sum.totalSpent">Total Spent (~63%)</div>
        </div>
        <div class="card summary-card pending">
          <div id="pending-budget" class="amount">KSh 1.22T</div>
          <div class="muted" data-i18n="sum.pending">Pending (~37%)</div>
        </div>
      </div>

      <p class="muted" style="margin-top:.5rem;" data-i18n="sources.note">Data sources: National Treasury, Controller of Budget, County Budgets (demo data shown).</p>
    </div>
  </section>

  <!-- ===== OPEN CONTRACTING PORTAL ===== -->
  <section id="open-contracting" aria-labelledby="contracts-title" style="margin-top:.5rem;">
    <div class="container">
      <h3 id="contracts-title" class="panel-title" style="font-size:1.6rem;" data-i18n="contracts.title">Open Contracting Portal</h3>
      <form role="search" class="grid" style="grid-template-columns: 1fr auto; gap:.6rem;">
        <label><span data-i18n="contracts.search">Search</span>
          <input type="search" name="q" placeholder="Project, contractor, tender ID" aria-label="Search contracts" />
        </label>
        <button class="btn" type="button" data-i18n="contracts.filter">Filter</button>
      </form>

      <div style="overflow:auto; margin-top:1rem;">
        <table aria-describedby="contracts-help">
          <caption id="contracts-help" class="muted" data-i18n="contracts.caption">Browse, sort, and flag contracts. (Sample structure)</caption>
          <thead>
            <tr>
              <th scope="col" data-i18n="contracts.tender">Tender ID</th>
              <th scope="col" data-i18n="contracts.project">Project</th>
              <th scope="col" data-i18n="contracts.contractor">Contractor</th>
              <th scope="col" data-i18n="contracts.award">Award Value (KSh)</th>
              <th scope="col" data-i18n="contracts.date">Award Date</th>
              <th scope="col" data-i18n="contracts.status">Status</th>
              <th scope="col" data-i18n="contracts.flags">Flags</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>PPIP-001</td>
              <td>Nairobi Ward Road Upgrade</td>
              <td>ABC Builders Ltd</td>
              <td>120,000,000</td>
              <td>2025-07-10</td>
              <td><span class="badge" data-status="ongoing" data-i18n="status.ongoing">Ongoing</span></td>
              <td><a href="#" style="color:var(--kenya-red); font-weight:700;" data-i18n="contracts.report">Report</a></td>
            </tr>
            <tr>
              <td>PPIP-002</td>
              <td>County Hospital Wing</td>
              <td>HealthWorks KE</td>
              <td>340,000,000</td>
              <td>2025-06-02</td>
              <td><span class="badge" data-status="awarded" data-i18n="status.awarded">Awarded</span></td>
              <td><a href="#" style="color:var(--kenya-red); font-weight:700;" data-i18n="contracts.report">Report</a></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </section>

  <!-- ===== PROJECT MONITORING ===== -->
  <section id="projects" aria-labelledby="projects-title">
    <div class="container">
      <h3 id="projects-title" class="panel-title" style="font-size:1.6rem;" data-i18n="projects.title">Project Monitoring</h3>
      <div class="grid grid-2">
        <div class="card" aria-label="Interactive map">
          <div id="map" role="application" aria-label="Project locations map"></div>
        </div>
        <div class="grid grid-2">
          <article class="card">
            <h4 style="color:var(--kenya-red); margin:0 0 .25rem;">Nakuru Dispensary</h4>
            <p class="muted" style="margin:.2rem 0 .4rem;">Health • Nakuru Town East</p>
            <p><strong>Budget:</strong> KSh 45M • <strong>Spent:</strong> KSh 20M</p>
            <label>Completion: <progress value="45" max="100">45%</progress></label>
            <details style="margin-top:.5rem;">
              <summary data-i18n="projects.updates">Updates</summary>
              <ul>
                <li>2025-08-01: Foundation complete (photo pending)</li>
                <li>2025-07-15: Contractor mobilized</li>
              </ul>
            </details>
          </article>
          <article class="card">
            <h4 style="color:var(--kenya-red); margin:0 0 .25rem;">Kisumu Road Upgrade</h4>
            <p class="muted" style="margin:.2rem 0 .4rem;">Roads • Kisumu Central</p>
            <p><strong>Budget:</strong> KSh 120M • <strong>Spent:</strong> KSh 90M</p>
            <label>Completion: <progress value="70" max="100">70%</progress></label>
            <details style="margin-top:.5rem;">
              <summary data-i18n="projects.updates">Updates</summary>
              <ul>
                <li>2025-08-10: Works slowed — awaiting materials</li>
                <li>2025-07-20: Drainage installed</li>
              </ul>
            </details>
          </article>
        </div>
      </div>
    </div>
  </section>

  <!-- ===== USSD & WHATSAPP ===== -->
  <section id="channels" aria-labelledby="channels-title" style="margin-top:.5rem;">
    <div class="container">
      <h3 id="channels-title" class="panel-title" style="font-size:1.6rem;" data-i18n="channels.title">USSD & WhatsApp Chatbot</h3>
      <div class="channels">
        <!-- USSD -->
        <div class="channel ussd">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M2 3h20v14H6l-4 4V3zm2 2v12.17L6.17 15H20V5H4zm10 2h2v6h-2V7zm-6 0h2v6H8V7z"/></svg>
          <div>
            <div class="big" data-i18n="channels.ussdDial">Dial <span style="color:var(--kenya-green)">*</span><span>456</span><span>*11#</span></div>
            <div class="muted" data-i18n="channels.ussdText">Check budgets, projects, and report issues from any phone.</div>
            <div style="margin-top:.5rem;">
              <button class="btn" type="button" onclick="alert('This is a demo. On a real phone, you would dial *456*11#.');" data-i18n="channels.how">How it works</button>
            </div>
          </div>
        </div>
        <!-- WhatsApp -->
        <div class="channel whatsapp">
          <svg viewBox="0 0 32 32" aria-hidden="true"><path fill="#25D366" d="M16 .6C7.6.6.8 7.4.8 15.8c0 2.7.7 5.2 2.1 7.4L.6 31.4l8.4-2.2c2.1 1.1 4.5 1.7 7 1.7 8.4 0 15.2-6.8 15.2-15.2S24.4.6 16 .6z"/><path fill="#fff" d="M24 19.6c-.4 1.1-2.1 2-2.9 2.1-.8.1-1.7.2-2.8-.2-3.1-1-5-3.5-5.1-3.7-.1-.1-1.2-1.6-1.2-3.1s.7-2.2 1-2.5c.4-.5.9-.6 1.2-.6h.9c.3 0 .7 0 1 .8.4.9 1.3 3.2 1.4 3.4.1.2.1.4 0 .6-.2.5-.5.9-.9 1.4-.2.2-.4.4-.2.8.2.4 1 1.6 2.2 2.6 1.5 1.3 2.8 1.7 3.3 1.9.4.2.7.2 1-.1.3-.3 1.2-1.4 1.5-1.8.3-.4.6-.4 1-.2l2.3 1.1c.5.2.8.4.9.6.1.2.1 1.3-.3 2.3z"/></svg>
          <div>
            <div class="big" data-i18n="channels.wa">Chat on WhatsApp: <a href="https://wa.me/254721606409" target="_blank" rel="noopener" class="btn" style="--bg:#25D366;" data-i18n="channels.openChat">Open Chat</a></div>
            <div class="muted" data-i18n="channels.waText">Save <strong>+254 721 606 409</strong> then say "Hello WaziHub".</div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- ===== REPORT ===== -->
  <section id="report" aria-labelledby="report-title">
    <div class="container">
      <h3 id="report-title" class="panel-title" style="font-size:1.6rem;" data-i18n="report.title">Report an Issue</h3>
      <p class="muted" data-i18n="report.help">Report delays, ghost projects, or misuse of funds. A tracking ID will be generated.</p>
      
      <form id="report-form" class="grid grid-2" novalidate>
        <label><span data-i18n="report.project">Project (link or name)</span>
          <input type="text" name="project" placeholder="e.g., Nakuru Dispensary" required />
          <small class="error-message" style="display: none; color: var(--kenya-red); font-size: 0.75rem; margin-top: 0.25rem;"></small>
        </label>
        <label><span data-i18n="report.location">Location</span>
          <input type="text" name="location" placeholder="County / Ward" required />
          <small class="error-message" style="display: none; color: var(--kenya-red); font-size: 0.75rem; margin-top: 0.25rem;"></small>
        </label>
        <label><span data-i18n="report.issueType">Issue Type</span>
          <select name="issue" required>
            <option value="">Select issue type...</option>
            <option data-i18n="issue.delay">Delay</option>
            <option data-i18n="issue.abandoned">Abandoned site</option>
            <option data-i18n="issue.quality">Quality concern</option>
            <option data-i18n="issue.corruption">Corruption / Irregularity</option>
          </select>
          <small class="error-message" style="display: none; color: var(--kenya-red); font-size: 0.75rem; margin-top: 0.25rem;"></small>
        </label>
        <label><span data-i18n="report.details">Details</span>
          <textarea name="details" rows="5" placeholder="Describe the issue…" required></textarea>
          <small class="error-message" style="display: none; color: var(--kenya-red); font-size: 0.75rem; margin-top: 0.25rem;"></small>
        </label>
        <label><span data-i18n="report.photo">Upload Photo (optional)</span>
          <input type="file" name="photo" accept="image/*" />
          <small class="help-text" style="color: var(--muted); font-size: 0.75rem; margin-top: 0.25rem;">Max 5MB. JPG, PNG, or GIF</small>
        </label>
        <label><span data-i18n="report.phone">Phone (optional for follow-up)</span>
          <input type="tel" name="phone" placeholder="07xx xxx xxx" pattern="[0-9]{10,12}" />
          <small class="help-text" style="color: var(--muted); font-size: 0.75rem; margin-top: 0.25rem;">For status updates</small>
        </label>
        <label style="flex-direction:row; align-items:center; gap:.5rem; grid-column: 1 / -1;">
          <input type="checkbox" name="consent" required /> 
          <span data-i18n="report.consent">I consent to share this information for accountability purposes.</span>
          <small class="error-message" style="display: none; color: var(--kenya-red); font-size: 0.75rem; margin-top: 0.25rem;"></small>
        </label>
        <div style="grid-column: 1 / -1; text-align: center;">
          <button type="submit" class="btn" data-i18n="report.submit" style="min-width: 200px;">
            <span class="btn-text">Submit Report</span>
            <span class="btn-loading" style="display: none;">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 2V6M12 18V22M4.93 4.93L7.76 7.76M16.24 16.24L19.07 19.07M2 12H6M18 12H22M4.93 19.07L7.76 16.24M16.24 7.76L19.07 4.93" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              Submitting...
            </span>
          </button>
        </div>
      </form>

      <!-- Success Message -->
      <div id="success-message" class="card" style="display: none; background: #f0fdf4; border-color: #bbf7d0; margin-top: 1rem;">
        <div style="display: flex; align-items: center; gap: 1rem;">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="#166534" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <div>
            <h4 style="margin: 0 0 0.5rem; color: #166534;">Report Submitted Successfully!</h4>
            <p style="margin: 0; color: #166534;">Your tracking ID: <strong id="tracking-id"></strong></p>
            <p style="margin: 0.5rem 0 0; font-size: 0.875rem; color: var(--muted);">We'll review your report and get back to you if you provided contact information.</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- ===== ABOUT / FOOTER ===== -->
  <section id="about" aria-labelledby="about-title">
    <div class="container">
      <h3 id="about-title" class="panel-title" style="font-size:1.6rem;" data-i18n="about.title">About Wazi Hub</h3>
      <p data-i18n="about.text">Wazi Hub is a Kenyan civic tech platform for budget transparency, open contracting, project monitoring, and citizen feedback. Built with the community, for the community.</p>
    </div>
  </section>

  <footer role="contentinfo">
    <div class="container">
      <p><strong>Wazi Hub</strong> — <span data-i18n="brand.tag">See More • Know More • Do More</span>.</p>
      <nav aria-label="Footer">
        <ul class="flex" style="flex-wrap:wrap;">
          <li><a href="#channels" data-i18n="nav.channels">USSD & WhatsApp</a></li>
          <li><a href="#sources" data-i18n="footer.sources">Data Sources</a></li>
          <li><a href="#privacy" data-i18n="footer.privacy">Privacy</a></li>
          <li><a href="#faq" data-i18n="footer.faq">FAQs</a></li>
        </ul>
      </nav>
      <p class="muted">© <span id="year">2025</span> Wazi Hub. All rights reserved.</p>
    </div>
  </footer>
</main>

<!-- ===== FLOATING ACTION BUTTON ===== -->
<a href="#report" class="fab" aria-label="Report an issue" title="Report an issue">
  <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
  </svg>
</a>

<script>
  // ===== FOOTER YEAR =====
  document.getElementById('year').textContent = new Date().getFullYear();

  // ===== FORMATTER =====
  const fmt = (n) => {
    if (n >= 1e12) return "KSh " + (n/1e12).toFixed(2) + "T";
    if (n >= 1e9)  return "KSh " + (n/1e9).toFixed(2) + "B";
    if (n >= 1e6)  return "KSh " + (n/1e6).toFixed(2) + "M";
    return "KSh " + n.toLocaleString();
  };

  // ===== SMOOTH SCROLLING =====
  document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
      e.preventDefault();
      const target = document.querySelector(this.getAttribute('href'));
      if (target) {
        target.scrollIntoView({
          behavior: 'smooth',
          block: 'start'
        });
      }
    });
  });

  // ===== LOADING STATES =====
  function showLoading(element) {
    element.classList.add('loading');
    element.style.position = 'relative';
  }

  function hideLoading(element) {
    element.classList.remove('loading');
  }

  // ===== ENHANCED BUTTON INTERACTIONS =====
  document.querySelectorAll('.btn').forEach(btn => {
    btn.addEventListener('click', function(e) {
      // Add ripple effect
      const ripple = document.createElement('span');
      const rect = this.getBoundingClientRect();
      const size = Math.max(rect.width, rect.height);
      const x = e.clientX - rect.left - size / 2;
      const y = e.clientY - rect.top - size / 2;
      
      ripple.style.width = ripple.style.height = size + 'px';
      ripple.style.left = x + 'px';
      ripple.style.top = y + 'px';
      ripple.classList.add('ripple');
      
      this.appendChild(ripple);
      
      setTimeout(() => {
        ripple.remove();
      }, 600);
    });
  });

  // Add ripple effect CSS
  const style = document.createElement('style');
  style.textContent = `
    .btn {
      position: relative;
      overflow: hidden;
    }
    .ripple {
      position: absolute;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.3);
      transform: scale(0);
      animation: ripple-animation 0.6s linear;
      pointer-events: none;
    }
    @keyframes ripple-animation {
      to {
        transform: scale(4);
        opacity: 0;
      }
    }
  `;
  document.head.appendChild(style);

  // ===== LANGUAGE: STRINGS =====
  const STR = {
    en: {
      "brand.name":"Wazi Hub","brand.tag":"See More • Know More • Do More",
      "nav.home":"Home","nav.budgets":"Budgets","nav.contracts":"Contracts","nav.projects":"Projects","nav.channels":"USSD & WhatsApp","nav.report":"Report","nav.about":"About",
      "hero.title":"See More. Know More. Do More.",
      "hero.text":"Track budgets, monitor projects, follow contracts, and hold leaders accountable — all in one easy dashboard built for everyone in Kenya.",
      "cta.budgets":"Explore Budgets","cta.contracts":"Open Contracting","cta.report":"Report an Issue",
      "hl.title":"Highlights","hl.a.title":"Where is your county's money going?","hl.a.text":"Quick view of allocations by sector for your county.",
      "hl.b.title":"Who won the latest tenders?","hl.b.text":"Search contractors, awards, and red flags.",
      "hl.c.title":"Is that road really 80% complete?","hl.c.text":"Project statuses, photos, and community updates.",
      "lang.label":"Language / Lugha:","lang.beta":"Translation (Beta)","lang.apply":"Apply",
      "budget.title":"Open Budget Tracker",
      "filters.year":"Year","filters.sector":"Sector","filters.county":"County","filters.allSectors":"All sectors","filters.allCounties":"All counties","filters.update":"Update Data",
      "chart.pieTitle":"Budget Allocation by Sector","chart.barTitle":"Planned vs Actual — Quarterly","chart.tip":"Tip: Tap a legend item to hide/show a series.",
      "sum.totalBudget":"Total Budget (selected)","sum.totalSpent":"Total Spent (~63%)","sum.pending":"Pending (~37%)",
      "sources.note":"Data sources: National Treasury, Controller of Budget, County Budgets (demo data shown).",
      "contracts.title":"Open Contracting Portal","contracts.search":"Search","contracts.filter":"Filter","contracts.caption":"Browse, sort, and flag contracts. (Sample structure)","contracts.tender":"Tender ID","contracts.project":"Project","contracts.contractor":"Contractor","contracts.award":"Award Value (KSh)","contracts.date":"Award Date","contracts.status":"Status","contracts.flags":"Flags","contracts.report":"Report",
      "status.ongoing":"Ongoing","status.awarded":"Awarded",
      "projects.title":"Project Monitoring","projects.updates":"Updates",
      "channels.title":"USSD & WhatsApp Chatbot","channels.ussdDial":"Dial *456*11#","channels.ussdText":"Check budgets, projects, and report issues from any phone.","channels.how":"How it works","channels.wa":"Chat on WhatsApp:","channels.openChat":"Open Chat","channels.waText":"Save +254 700 000 000 then say \"Hello Wazi\".",
      "report.title":"Report an Issue","report.help":"Report delays, ghost projects, or misuse of funds. A tracking ID will be generated.","report.project":"Project (link or name)","report.location":"Location","report.issueType":"Issue Type","report.details":"Details","report.photo":"Upload Photo (optional)","report.phone":"Phone (optional for follow-up)","report.consent":"I consent to share this information for accountability purposes.","report.submit":"Submit Report",
      "about.title":"About Wazi Hub","about.text":"Wazi Hub is a Kenyan civic tech platform for budget transparency, open contracting, project monitoring, and citizen feedback. Built with the community, for the community.",
      "footer.sources":"Data Sources","footer.privacy":"Privacy","footer.faq":"FAQs"
    },
    sw: { // Kiswahili
      "brand.name":"Wazi Hub","brand.tag":"Ona Zaidi • Fahamu Zaidi • Fanya Zaidi",
      "nav.home":"Nyumbani","nav.budgets":"Bajeti","nav.contracts":"Mikataba","nav.projects":"Miradi","nav.channels":"USSD & WhatsApp","nav.report":"Ripoti","nav.about":"Kuhusu",
      "hero.title":"Ona Zaidi. Fahamu Zaidi. Fanya Zaidi.",
      "hero.text":"Fatilia bajeti, fuatilia miradi, angalia mikataba, na wawajibishe viongozi — kwenye dashibodi rahisi kwa wote nchini Kenya.",
      "cta.budgets":"Chunguza Bajeti","cta.contracts":"Uwazi wa Ununuzi","cta.report":"Toa Taarifa",
      "hl.title":"Mambo Muhimu","hl.a.title":"Fedha za kaunti yako zinaenda wapi?","hl.a.text":"Muhtasari wa mgao kwa sekta katika kaunti yako.",
      "hl.b.title":"Nani alipata zabuni za karibuni?","hl.b.text":"Tafuta wakandarasi, tuzo na viashiria hatarishi.",
      "hl.c.title":"Je, barabara hiyo imekamilika 80% kweli?","hl.c.text":"Hali ya miradi, picha na taarifa za jamii.",
      "lang.label":"Lugha:","lang.beta":"Tafsiri (Beta)","lang.apply":"Tumia",
      "budget.title":"Kifuatiliaji cha Bajeti",
      "filters.year":"Mwaka","filters.sector":"Sekta","filters.county":"Kaunti","filters.allSectors":"Sekta zote","filters.allCounties":"Kaunti zote","filters.update":"Sasisha Data",
      "chart.pieTitle":"Mgao wa Bajeti kwa Sekta","chart.barTitle":"Zilizopangwa dhidi ya Halisi — Robo Mwaka","chart.tip":"Kidokezo: Gonga katika hadithi kuficha/kuonyesha mfululizo.",
      "sum.totalBudget":"Jumla ya Bajeti (zilizochaguliwa)","sum.totalSpent":"Jumla Iliyotumika (~63%)","sum.pending":"Bado (~37%)",
      "sources.note":"Vyanzo: Hazina ya Taifa, Mdhibiti wa Bajeti, Bajeti za Kaunti (data ya mfano).",
      "contracts.title":"Kituo cha Ununuzi Wazi","contracts.search":"Tafuta","contracts.filter":"Chuja","contracts.caption":"Vinjari, panga na weka alama mikataba. (Mfano)","contracts.tender":"Nambari ya Zabuni","contracts.project":"Mradi","contracts.contractor":"Mkandarasi","contracts.award":"Thamani ya Tuzo (KSh)","contracts.date":"Tarehe ya Tuzo","contracts.status":"Hali","contracts.flags":"Alama","contracts.report":"Ripoti",
      "status.ongoing":"Inaendelea","status.awarded":"Imetunukiwa",
      "projects.title":"Ufuatiliaji wa Miradi","projects.updates":"Taarifa",
      "channels.title":"USSD & WhatsApp Chatbot","channels.ussdDial":"Piga *456*11#","channels.ussdText":"Angalia bajeti, miradi, na toa taarifa kwa simu yoyote.","channels.how":"Jinsi inavyofanya kazi","channels.wa":"Soga WhatsApp:","channels.openChat":"Fungua Mazungumzo","channels.waText":"Hifadhi +254 700 000 000 kisha sema \"Hello Wazi\".",
      "report.title":"Toa Taarifa","report.help":"Ripoti ucheleweshaji, miradi hewa au matumizi mabaya ya fedha. Utapata nambari ya ufuatiliaji.","report.project":"Mradi (kiungo au jina)","report.location":"Eneo","report.issueType":"Aina ya Tatizo","report.details":"Maelezo","report.photo":"Pakia Picha (hiari)","report.phone":"Simu (hiari kwa ufuatiliaji)","report.consent":"Ninakubali kushiriki taarifa hizi kwa uwajibikaji.","report.submit":"Wasilisha",
      "about.title":"Kuhusu Wazi Hub","about.text":"Wazi Hub ni jukwaa la uwazi wa bajeti, ununuzi wazi, ufuatiliaji wa miradi na mrejesho wa wananchi.",
      "footer.sources":"Vyanzo vya Data","footer.privacy":"Faragha","footer.faq":"Maswali"
    },
    // Short community translations (concise; demo scope)
    ki: { "nav.home":"Mũciĩ","nav.budgets":"Bajeti","nav.contracts":"Mikataba","nav.projects":"Mĩtugo","nav.channels":"USSD & WhatsApp","nav.report":"Rĩpoti","nav.about":"Ũhoro",
          "hero.title":"Ona mĩgambo, mũtũgũrũka, kora gũkũ.","cta.budgets":"Tũrone Bajeti","budget.title":"Kĩgũrũkia Bajeti",
          "filters.year":"Mwaka","filters.sector":"Kĩanda","filters.county":"Kaũnti","filters.allSectors":"Ma-anda mothe","filters.allCounties":"Ma-kaũnti mothe","filters.update":"Hũthũria Data",
          "chart.pieTitle":"Kũgawio kwa Ma-anda","chart.barTitle":"Matarĩtũ na Ma-hĩndĩ — Rũbũ","projects.title":"Kũthungatira Mĩtugo",
          "report.title":"Rĩpoti ĩtua","channels.title":"USSD & WhatsApp"}
    ,
    luo: {"nav.home":"Od bura","nav.budgets":"Budget","nav.contracts":"Kondract","nav.projects":"Projek","nav.report":"Ripoti","hero.title":"Neno Mabor. Ng'eyo Mabor. Timo Mabor.","cta.budgets":"Nen Budget","budget.title":"Lonyo Budget","filters.year":"Higa","filters.sector":"Secta","filters.county":"County","filters.update":"Yik Data","chart.pieTitle":"Goyo Budget gi Secta","chart.barTitle":"Ma oseyie gi Ma timore — Quarter","projects.title":"Timo Neno Projek"},
    kamba: {"nav.home":"Mũkaũ","cta.budgets":"Yona Bajeti","budget.title":"Kiw'ang'a kya Bajeti","filters.year":"Muaka","filters.sector":"Sekta","filters.county":"Kaunti","filters.update":"Sasya Data","chart.pieTitle":"Utethyo wa Bajeti kwa Sekta","chart.barTitle":"Ila Syaikite na Ila Syaikw'ata — Kwetani"},
    luy: {"nav.home":"Ing'anda","filters.year":"Omwaka","filters.sector":"Omusekta","filters.county":"County","filters.update":"Sasula Data","budget.title":"Sikuli ya Budget"},
    kal: {"budget.title":"Budgetit ne Imet","filters.year":"Met","filters.sector":"Sekta","filters.county":"County","filters.update":"Tayin Data","chart.pieTitle":"Tugul Budget ko Setkait"},
    som: {"nav.home":"Guri","budget.title":"Dabagalka Miisaaniyadda","filters.year":"Sannad","filters.sector":"Qeyb","filters.county":"County","filters.update":"Cusbooneysii","chart.pieTitle":"Qeybinta Miisaaniyadda"},
    tuk: {"nav.home":"Akirok","budget.title":"Budget Akirok","filters.year":"Akur","filters.sector":"Ngakipi","filters.county":"County","filters.update":"Akosi Data"},
    meru: {"nav.home":"Mucee","budget.title":"Kĩgwatĩria Kĩa Budget","filters.year":"Mwaka","filters.sector":"Sekita","filters.county":"Kaunti","filters.update":"Tigithia Data"}
  };

  function translateContent(lang){
    const dict = STR[lang] || STR.en;
    document.querySelectorAll('[data-i18n]').forEach(el=>{
      const key = el.getAttribute('data-i18n');
      if(dict[key]) el.textContent = dict[key];
    });
    localStorage.setItem('wazi-lang', lang);
  }

  // Apply stored language on load
  const storedLang = localStorage.getItem('wazi-lang') || 'en';
  document.getElementById('language-select').value = storedLang;
  translateContent(storedLang);
  document.getElementById('apply-lang').addEventListener('click', ()=>{
    const lang = document.getElementById('language-select').value;
    translateContent(lang);
  });

  // ===== DEMO BUDGET DATA (by sector; base) =====
  const sectorPalette = {
    "Health":"#ff6b35","Education":"#f7931e","Infrastructure":"#ffd23f","Agriculture":"#06d6a0",
    "Water & Sanitation":"#118ab2","Security":"#073b4c","Transport":"#7209b7","Energy":"#aacc00",
    "Governance":"#f94144","Environment":"#2a9d8f","Trade & Industry":"#f3722c","Tourism":"#43aa8b",
    "Youth Affairs":"#577590","Gender & Social Services":"#f8961e"
  };

  const baseData = {
    "Health":{planned: 850e9, actual: 720e9},
    "Education":{planned: 920e9, actual: 850e9},
    "Infrastructure":{planned: 680e9, actual: 450e9},
    "Agriculture":{planned: 320e9, actual: 280e9},
    "Water & Sanitation":{planned: 280e9, actual: 230e9},
    "Security":{planned: 450e9, actual: 420e9},
    "Transport":{planned: 390e9, actual: 310e9},
    "Energy":{planned: 260e9, actual: 210e9},
    "Governance":{planned: 150e9, actual: 120e9},
    "Environment":{planned: 95e9, actual: 80e9},
    "Trade & Industry":{planned: 110e9, actual: 90e9},
    "Tourism":{planned: 70e9, actual: 52e9},
    "Youth Affairs":{planned: 55e9, actual: 40e9},
    "Gender & Social Services":{planned: 60e9, actual: 48e9}
  };

  // Year multipliers (dummy)
  const yearMul = {
    "2025/26":1.06,"2024/25":1.00,"2023/24":0.96,"2022/23":0.92,"2021/22":0.90,"2020/21":0.88,"2019/20":0.86,"2018/19":0.82
  };

  // County scalers (dummy; larger for some)
  const countyScale = {
    default: 1.0, nairobi: 1.25, nakuru: 1.12, kiambu: 1.1, mombasa: 1.08, kakamega:1.06, kisumu:1.05
  };

  // ===== CHARTS =====
  const pieCtx = document.getElementById('pie').getContext('2d');
  const barCtx = document.getElementById('bars').getContext('2d');
  let pieChart, barChart;

  function makePie(data){
    const labels = Object.keys(data);
    const values = labels.map(k => data[k].planned);
    const colors = labels.map(l => sectorPalette[l] || '#ccc');
    return new Chart(pieCtx, {
      type: 'pie',
      data: { labels, datasets: [{ data: values, backgroundColor: colors, borderColor: '#ffffff', borderWidth: 2 }]},
      options: {
        plugins:{
          legend:{ display:false },
          tooltip:{ callbacks:{ label:(ctx)=> `${ctx.label}: ${fmt(ctx.parsed)}` } }
        }
      }
    });
  }

  function makeBars(data){
    const labels = ["Q1","Q2","Q3","Q4"];
    const plannedTotal = Object.values(data).reduce((s,v)=>s+v.planned,0);
    const actualTotal  = Object.values(data).reduce((s,v)=>s+v.actual,0);
    // Simple quarterly splits (dummy)
    const p = [0.24,0.26,0.26,0.24].map(r=> Math.round(plannedTotal*r));
    const a = [0.20,0.23,0.25,0.22].map((r,i)=> Math.min(Math.round(actualTotal*r), p[i])); // cap actual <= planned per quarter
    return new Chart(barCtx, {
      type:'bar',
      data:{
        labels,
        datasets:[
          { label:'Planned', data:p, backgroundColor:'rgba(0,133,63,0.85)' },
          { label:'Actual',  data:a, backgroundColor:'rgba(187,25,25,0.9)' }
        ]
      },
      options:{
        responsive:true,
        maintainAspectRatio:false,
        interaction:{ mode:'index', intersect:false },
        scales:{
          y:{ ticks:{ callback:(v)=> (v/1e9)+'B' } }
        }
      }
    });
  }

  function buildLegend(data){
    const el = document.getElementById('pie-legend');
    el.innerHTML = '';
    for(const [label,vals] of Object.entries(data)){
      const color = sectorPalette[label] || '#ccc';
      const item = document.createElement('div');
      item.innerHTML = `<span style="display:inline-block;width:14px;height:14px;border-radius:3px;background:${color};margin-right:8px;vertical-align:middle;"></span>${label} — <strong>${fmt(vals.planned)}</strong>`;
      el.appendChild(item);
    }
  }

  function updateCards(data){
    const planned = Object.values(data).reduce((s,v)=>s+v.planned,0);
    const actual  = Object.values(data).reduce((s,v)=>s+v.actual,0);
    const pending = Math.max(planned-actual, 0);
    document.getElementById('total-budget').textContent = fmt(planned);
    document.getElementById('total-spent').textContent  = fmt(actual);
    document.getElementById('pending-budget').textContent = fmt(pending);
  }

  function filterBySector(data, sector){
    if(!sector || sector==="All sectors" || sector==="Sekta zote" || sector==="Sekta zote") return data;
    const filtered = {};
    if(data[sector]) filtered[sector] = data[sector];
    return filtered;
  }

  function scaleForCounty(data, countyVal){
    const key = (countyVal||'').toLowerCase();
    const scale = countyScale[key] || countyScale.default;
    const scaled = {};
    for(const k in data){
      scaled[k] = {
        planned: Math.round(data[k].planned*scale),
        actual : Math.round(data[k].actual *Math.min(scale, 1.15))
      };
    }
    return scaled;
  }

  function scaleForYear(data, year){
    const mul = yearMul[year] || 1;
    const scaled = {};
    for(const k in data){
      scaled[k] = {
        planned: Math.round(data[k].planned*mul),
        actual : Math.round(data[k].actual *mul*0.97) // slight execution gap
      };
    }
    return scaled;
  }

  function drawAll(){
    const sectorSel = document.getElementById('sector').value;
    const countySel = document.getElementById('county').value;
    const yearSel   = document.getElementById('year').value;
    let data = scaleForYear(baseData, yearSel);
    data = scaleForCounty(data, countySel);
    data = filterBySector(data, sectorSel);

    if(pieChart) pieChart.destroy();
    if(barChart) barChart.destroy();

    pieChart = makePie(data);
    barChart = makeBars(data);
    buildLegend(data);
    updateCards(data);
  }

  document.getElementById('update').addEventListener('click', drawAll);

  // Initial charts render
  drawAll();

  // ===== MAP: DUMMY PROJECT PINS =====
  // Map centered roughly on Kenya
  const map = L.map('map', { zoomControl: true }).setView([0.3, 37.8], 6);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 18, attribution: '&copy; OpenStreetMap'
  }).addTo(map);

  const projects = [
    { name:"Nairobi Ward Road Upgrade", sector:"Transport", county:"Nairobi", lat:-1.286, lng:36.817, budget: 120e6, spent: 75e6, progress:62, status:"Ongoing" },
    { name:"Kisumu Waterfront Drainage", sector:"Water & Sanitation", county:"Kisumu", lat:-0.0917, lng:34.7680, budget: 90e6, spent: 60e6, progress:70, status:"Ongoing" },
    { name:"Mombasa Clinic Expansion", sector:"Health", county:"Mombasa", lat:-4.0435, lng:39.6682, budget: 65e6, spent: 58e6, progress:88, status:"Awarded" },
    { name:"Garissa Solar Mini-Grid", sector:"Energy", county:"Garissa", lat:-0.453, lng:39.646, budget: 150e6, spent: 40e6, progress:28, status:"Ongoing" },
    { name:"Nakuru Dispensary", sector:"Health", county:"Nakuru", lat:-0.3031, lng:36.0800, budget: 45e6, spent: 20e6, progress:45, status:"Ongoing" },
    { name:"Eldoret Agro Park", sector:"Agriculture", county:"Uasin Gishu", lat:0.5143, lng:35.2698, budget: 210e6, spent: 95e6, progress:41, status:"Ongoing" }
  ];

  projects.forEach(p=>{
    const popup = `
      <strong>${p.name}</strong><br/>
      <em>${p.sector} • ${p.county}</em><br/>
      <div>Budget: <strong>${fmt(p.budget)}</strong> &nbsp; • &nbsp; Spent: <strong>${fmt(p.spent)}</strong></div>
      <div>Status: <span class="badge" style="vertical-align:middle;">${p.status}</span></div>
      <div style="margin-top:.3rem;">Progress:
        <progress value="${p.progress}" max="100" style="width:100%">${p.progress}%</progress>
      </div>
    `;
    L.marker([p.lat,p.lng]).addTo(map).bindPopup(popup);
  });

  // ===== FORM VALIDATION AND SUBMISSION =====
  const reportForm = document.getElementById('report-form');
  const successMessage = document.getElementById('success-message');
  const trackingIdElement = document.getElementById('tracking-id');

  function showError(input, message) {
    const errorElement = input.parentElement.querySelector('.error-message');
    errorElement.textContent = message;
    errorElement.style.display = 'block';
    input.style.borderColor = 'var(--kenya-red)';
  }

  function hideError(input) {
    const errorElement = input.parentElement.querySelector('.error-message');
    errorElement.style.display = 'none';
    input.style.borderColor = '#d1d5db';
  }

  function validateForm() {
    let isValid = true;
    const requiredFields = reportForm.querySelectorAll('[required]');
    
    requiredFields.forEach(field => {
      if (field.type === 'checkbox') {
        if (!field.checked) {
          showError(field, 'This field is required');
          isValid = false;
        } else {
          hideError(field);
        }
      } else {
        if (!field.value.trim()) {
          showError(field, 'This field is required');
          isValid = false;
        } else {
          hideError(field);
        }
      }
    });

    // Validate phone number if provided
    const phoneField = reportForm.querySelector('input[name="phone"]');
    if (phoneField.value.trim() && !phoneField.checkValidity()) {
      showError(phoneField, 'Please enter a valid phone number');
      isValid = false;
    }

    return isValid;
  }

  function generateTrackingId() {
    const timestamp = Date.now().toString(36);
    const random = Math.random().toString(36).substr(2, 5);
    return `WH-${timestamp}-${random}`.toUpperCase();
  }

  function showLoadingState(button) {
    const btnText = button.querySelector('.btn-text');
    const btnLoading = button.querySelector('.btn-loading');
    btnText.style.display = 'none';
    btnLoading.style.display = 'inline-flex';
    button.disabled = true;
  }

  function hideLoadingState(button) {
    const btnText = button.querySelector('.btn-text');
    const btnLoading = button.querySelector('.btn-loading');
    btnText.style.display = 'inline';
    btnLoading.style.display = 'none';
    button.disabled = false;
  }

  reportForm.addEventListener('submit', async function(e) {
    e.preventDefault();
    
    if (!validateForm()) {
      return;
    }

    const submitButton = this.querySelector('button[type="submit"]');
    showLoadingState(submitButton);

    // Simulate API call
    try {
      await new Promise(resolve => setTimeout(resolve, 2000));
      
      // Generate tracking ID
      const trackingId = generateTrackingId();
      trackingIdElement.textContent = trackingId;
      
      // Show success message
      reportForm.style.display = 'none';
      successMessage.style.display = 'block';
      
      // Scroll to success message
      successMessage.scrollIntoView({ behavior: 'smooth', block: 'start' });
      
    } catch (error) {
      console.error('Submission failed:', error);
      alert('Failed to submit report. Please try again.');
    } finally {
      hideLoadingState(submitButton);
    }
  });

  // Real-time validation
  reportForm.querySelectorAll('input, select, textarea').forEach(field => {
    field.addEventListener('blur', function() {
      if (this.hasAttribute('required')) {
        if (this.type === 'checkbox') {
          if (!this.checked) {
            showError(this, 'This field is required');
          } else {
            hideError(this);
          }
        } else if (!this.value.trim()) {
          showError(this, 'This field is required');
        } else {
          hideError(this);
        }
      }
    });

    field.addEventListener('input', function() {
      if (this.value.trim()) {
        hideError(this);
      }
    });
  });

  // File size validation
  const photoInput = reportForm.querySelector('input[name="photo"]');
  photoInput.addEventListener('change', function() {
    const file = this.files[0];
    if (file && file.size > 5 * 1024 * 1024) { // 5MB
      alert('File size must be less than 5MB');
      this.value = '';
    }
  });

</script>
</body>
</html>
